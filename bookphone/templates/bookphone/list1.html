{% extends 'bookphone/base.html' %}

{% load staticfiles %}
{% load static %}
{% load utils %}

{% block content%}
<div class=right_col>
    <div class="">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="row">
                <div class="col-md-10" align="right">
                    <div class="page-title" align="center">
                        <h3><font face="Cooper Black">{{se.name}}</font></h3>

                    </div>
                </div>
                <div class="col-md-2">
                    {% block back %}
                    {% endblock %}
                </div>
            </div>
        </div>
        <div class="row">
            {% block home %}
            <div class="col-md-7 col-sm-12 col-xs-12">
                <div class="row">
                    <div class="col-md-12">
                        <!-- Nav tabs -->
                        <div class="card">
                            <ul class="nav nav-tabs" role="tablist">
                                <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab"
                                                                          data-toggle="tab"><i class="fa fa-home"></i> 
                                    <span>Informacion</span></a>
                                </li>
                                <li role="presentation"><a href="#profile" aria-controls="profile" role="tab"
                                                           data-toggle="tab"><i class="fa fa-user"></i> 
                                    <span>Personal</span></a>
                                </li>
                            </ul>

                            <!-- Tab panes -->
                            <div class="tab-content">
                                <div role="tabpanel" class="tab-pane active" id="home">
                                    <div class="">
                                        <div class="row">
                                            <div class="col-md-3" align="right">
                                                <img src="{% static 'build/images/tel.png' %} ">
                                            </div>
                                            <div class="col-md-9">
                                                <h2><font face="Monotype Corsiva" size="4px">NUMERO</font></h2>
                                                <h4><font size="4px">{{ se.number}}</font></h4>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-3" align="right">
                                                <img src="{% static 'build/images/fax.png' %} ">
                                            </div>
                                            <div class="col-md-9">
                                                <h2><font face="Monotype Corsiva" size="4px">FAX</font></h2>
                                                <h4><font size="4px">{{ se.fax}}</font></h4>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-3" align="right">
                                                <img src="{% static 'build/images/dir.png' %} ">
                                            </div>
                                            <div class="col-md-9">
                                                <h2><font face="Monotype Corsiva" size="4px">DIRECCION</font></h2>
                                                <h4><font size="4px">{{ se.address}}</font></h4>
                                            </div>
                                        </div>
                                        <br>
                                        <br>
                                        <div class="map-area" align="center">
                                            <h2><font face="Monotype Corsiva" size="4px">UBICACION</font></h2>
                                            <div>
                                                <div class="col-12 box box-body" onload="initialize()">
                                                    <div class="white-box">
                                                        <p><strong>Ubicacion</strong></p>
                                                        <div id="gmap" class="map"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <br>
                                            <br>
                                            <br>
                                            <button id="btn_editar">editar</button>
                                            <a rel="tooltip" title="Eliminar" class="btn btn-simple btn-danger btn-icon table-action remove"
                                               href="#" data-href="{% url 'delete_secretaria' se.id %}" data-toggle="modal" data-target="#confirm-delete">
                                                <i class="glyphicon glyphicon-remove"></i>
                                            </a>
                                        </div>
                                        <!--<div class="boton">
                                            <i class="fa fa-map-marker" aria-hidden="true" style="color: white font-size:100x;"></i>
                                        </div>-->
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane" id="profile">
                                    <div class="container-fluid">
                                        <div class="panel panel-success">
                                            <div class="panel-heading">
                                                <input type="text" class="form-control" id="dev-table-filter"
                                                       data-action="filter" data-filters="#dev-table"
                                                       placeholder="Buscar Personal"/>
                                            </div>
                                            <div class="panel-body table-responsive">
                                                <table class="table table-hover" id="dev-table">
                                                    <thead>
                                                    <tr>
                                                        <th class="text-center">#</th>
                                                        <th class="text-center"> NOMBRE</th>
                                                        <th class="text-center"> APELLIDO</th>
                                                        <th class="text-center"> CARGO</th>
                                                        <th class="text-center"></th>
                                                        <!--<th class="text-center"> TELEFONO</th>
                                                        <th class="text-center"> CELULAR</th>-->
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% for persona in personal %}
                                                    <tr class="edit" id="detail">
                                                        <td id="no" class="text-center">{{forloop.counter}}</td>
                                                        <td id="name" class="text-center"> {{persona.name}}</td>
                                                        <td id="mobile" class="text-center">{{persona.lastname}}</td>
                                                        <td id="mail" class="text-center">{{persona.position}}</td>
                                                        <td id="" class="text-center">
                                                            <a href="{% url 'personal-secretaria' persona.id %}"
                                                               class="btn btn-danger" data-toggle="tooltip"
                                                               data-placement="bottom" title="DETALLES"><em
                                                                    class="fa fa-plus"></em></a>
                                                        </td>
                                                        <!--<td id="t" class="text-center">{{persona.telephone}}</td>
                                                        <td id="city" class="text-center">{{persona.phone}}</td>-->
                                                    </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endblock %}

            {% block personal %}
            {% endblock %}

            {% block personal_unidad %}
            {% endblock %}

            {% block unidad %}
            <div class="col-md-5 col-sm-12 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        <div class=" clearfix">
                            <h2><img src="{% static 'build/images/secre.png' %}"> Direcciones/Unidades </h2>
                            <button type="button" class="btn btn-primary" data-toggle="modal"
                                    data-target="#exampleModal">
                                Launch demo modal
                            </button>
                        </div>
                    </div>
                    {% get_unidad se.id as unid %}
                    {% for u in unid %}
                    <div class="boton3 nav" id="activo{{u.id}}">
                        <a href="{% url 'unidad' u.id %}" id="{{u.id}}">
                            <i class="fa fa-hand-o-right" aria-hidden="true"></i> {{ u.name }}
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endblock %}
        </div>
    </div>
</div>

<div class="modal fade" id="modal_edit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog modal-sm " role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Registrar Nueva Planilla</h4>
      </div>
      <div class="modal-body">
        <di class="form-horizontal form-label-left">
          <div class="col-md-12 col-sm-12 col-xs-12">
              <p class="text-center">
                  <span><label>PLANILLA</label></span>
              </p>
          </div>
            <form class="form-group form-horizontal" method="POST" action="{% url 'editar_secretaria' se.id %}">
                {% csrf_token %}
                {% for imput in form %}
              <div class="form-group">
                <label class="col-md-3 control-label">
                    {{imput.label}}
                </label>
                <div class="col-md-9">
                      {{imput}}
                </div>
              </div>
                {% endfor %}
              <div class="clearfix"></div>
              <div class="modal-footer">
                 <button type="submit" class="btn btn-dark" id="modal_planilla_btn_save">Guardar</button>
                 <button type="close" class="btn btn-default" id="modal_planilla_btn_close">Cancelar</button>
              </div>
            </form>
    </div>
  </div>
</div>


<div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                Confirmacion de eliminación
            </div>
            <div class="modal-body">
                <strong class="text-danger">Esta seguro de eliminar?</strong>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-black" data-dismiss="modal">Cancelar</button>
                <a class="btn btn-danger btn-ok">Aceptar</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
{% include 'bookphone/url_maps.html' %}
<script type="text/javascript">
        var map;
        var markers = [];
        var lat = '{{ se.lat }}';
        var lng = '{{ se.lng }}';
        function initialize() {
            var myLatlng = new google.maps.LatLng(lat, lng);
            var myOptions = {
                zoom: 19,
                center: myLatlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            map = new google.maps.Map(document.getElementById("gmap"), myOptions);

            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, lng),
                map: map
            });
            markers.push(marker);
        }

        window.onload = function () {
            initialize()
        };
</script>
<script>
    $('#btn_editar').on('click',function(){
        $('#modal_edit').modal('show');
    });
</script>

<script>
    $(document).ready(function () {
            $('[data-tooltip="tooltip"]').tooltip();
            $('[title]').tooltip();

            $('#confirm-delete').on('show.bs.modal', function (e) {

                var title = $(e.relatedTarget).data('title');
                var message = $(e.relatedTarget).data('message');

                if (title !== undefined)
                    $(this).find('.modal-header').html(title);
                if (message !== undefined)
                    $(this).find('.modal-body').html('<strong class="text-warning">' + message + '</strong>');
                $(this).find('.btn-ok').attr('href', $(e.relatedTarget).data('href'));
            });
        })

</script>


<script>
$('#group_unit').children('a').eq({{un.id}}).addClass('current-page');
$('#{{u.id}}').addClass('current-page');

(function(){
    'use strict';
	var $ = jQuery;
	$.fn.extend({
		filterTable: function(){
			return this.each(function(){
				$(this).on('keyup', function(e){
					$('.filterTable_no_results').remove();
					var $this = $(this),
                        search = $this.val().toLowerCase(),
                        target = $this.attr('data-filters'),
                        $target = $(target),
                        $rows = $target.find('tbody tr');

					if(search == '') {
						$rows.show();
					} else {
						$rows.each(function(){
							var $this = $(this);
							$this.text().toLowerCase().indexOf(search) === -1 ? $this.hide() : $this.show();
						})
						if($target.find('tbody tr:visible').size() === 0) {
							var col_count = $target.find('tr').first().find('td').size();
							var no_results = $('<tr class="filterTable_no_results"><td colspan="'+col_count+'">Sin resultados</td></tr>')
							$target.find('tbody').append(no_results);
						}
					}
				});
			});
		}
	});
	$('[data-action="filter"]').filterTable();
})(jQuery);



</script>
{% endblock %}